import{_ as v,o as a,c as n,b as u,n as N,t as b,a as g,L as x,r as k,F as h,e as y,h as p,g as C,d as L}from"./index.3ee0ddbb.js";import{P}from"./PageGenerator.1883bf6e.js";const S={props:["moduleName","name","index","type","placeholder","value","target","validation","message"],emits:["cellChange","showMessage"],data(){return{error:!1,color:"rounded border border-success p-1"}},methods:{update(t){if(this.type=="checkbox")return this.$emit("cellChange",this.index,this.name,t.target.checked);if(this.type=="combobox")return this.$emit("cellChange",this.index,this.name,t.target.value);this.validation&&(this.error=!String(t.target.value).toLowerCase().match(this.validation)),this.error?this.color="rounded border border-danger p-1":this.color="rounded border border-warning p-1",this.error&&this.$emit("showMessage",this.message,"error"),this.$emit("cellChange",this.index,this.name,t.target.value)}}},M=["type","placeholder","value","id","checked"],E={key:0,class:"px-1"},G=["name","id"];function B(t,o,e,d,r,i){return a(),n("div",null,[u("input",{type:e.type,placeholder:e.placeholder,value:e.value,onChange:o[0]||(o[0]=(...m)=>i.update&&i.update(...m)),class:N(r.color),id:e.name,checked:e.value},null,42,M),e.type=="checkbox"?(a(),n("label",E,b(e.placeholder),1)):g("",!0),e.type=="button"?(a(),n("button",{key:1,name:e.name,id:e.index,onClick:o[1]||(o[1]=m=>t.$router.push("/"+t.ref)),class:"btn btn-secondary"},b(e.placeholder),9,G)):g("",!0)])}const F=v(S,[["render",B]]);const O={props:["token","user","moduleName","Model","models","fields","auxiliar","hasPermission"],emits:["showMessage","createOne","updateOne","deleteOne","changeStatus"],data(){return{model:{},Lenguages:x}},created(){this.clear()},computed:{display(){return this.models.length?this.$refs.PageGenerator.paginate(this.models):[]}},methods:{clear(){this.model=new this.Model({})},showMessage(t,o){this.$emit("showMessage",t,o)},onChange(t,o,e){if(t==-1)this.model[o]=e;else{const d=this.$refs.PageGenerator.getIndex(t);this.models[d][o]=e}},format(t,o,e){if(o){if(o=="datetime")return new Date(t).toLocaleString();if(o=="date")return new Date(t).toLocaleDateString();if(o=="time")return new Date(t).toLocaleTimeString();if(o=="checkbox")return t?"S\xED":"No";if(o=="combobox"||o=="status"){const d=this.auxiliar[e].find(r=>r._id===t);return d?d.name:t}else if(o=="multiple"){let d="";return t.forEach(r=>{const i=this.auxiliar[e].find(m=>m._id===r);i&&(d+=i.name+`
`)}),d}}else return t},sortBy(t,o=!1){this.models.sort((e,d)=>{let r=e[t].toLowerCase(),i=d[t].toLowerCase();return o?r<i?1:r>i?-1:0:r<i?-1:r>i?1:0})},updateSelect(t,o,e,d=!1){if(d){const r=[],i=document.getElementById("multiple"+t).options;for(const m of i)m.selected&&r.push(m.value);t!=-1?this.models[t][o]=r:this.model[o]=r}else t!=-1?this.models[this.$refs.PageGenerator.getIndex(t)][o]=e:this.model[o]=e},checkSelected(t,o,e){return e=="multiple"?o.find(d=>d==t):t==o}},components:{EditableCell:F,PageGenerator:P}},D={class:"row mt-1"},I={class:"table table-striped mt-3"},T={key:0},V={class:"btn-group-vertical"},z=["onClick"],j=u("i",{class:"fa-solid fa-arrow-up-a-z"},null,-1),q=[j],A=["onClick"],H=u("i",{class:"fa-solid fa-arrow-down-z-a"},null,-1),J=[H],K={key:0},Q={class:"btn-group"},R=["title"],U=u("i",{class:"fa-solid fa-floppy-disk"},null,-1),W=[U],X=["title"],Y=u("i",{class:"fa-solid fa-delete-left"},null,-1),Z=[Y],$=["name","multiple","id","onFocusout"],ee=["value"],te={key:0},se={class:"btn-group"},oe=["title","onClick"],ae=u("i",{class:"fa-solid fa-floppy-disk"},null,-1),ne=[ae],le=["title","onClick"],re=u("i",{class:"fa-solid fa-trash"},null,-1),ie=[re],ue={key:0,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:"Cambiar estado",class:"btn text-light",style:{background:"#002133"}},de={class:"dropdown-menu"},ce=["onClick"],me=["name","id","multiple","onFocusout"],he=["value","selected"],ge={key:3};function _e(t,o,e,d,r,i){const m=k("EditableCell"),f=k("PageGenerator");return a(),n(h,null,[u("div",D,[u("table",I,[u("thead",null,[u("tr",null,[e.moduleName!="logs"?(a(),n("th",T)):g("",!0),(a(!0),n(h,null,y(e.fields,(l,c)=>(a(),n("th",{key:c,scope:"col"},[u("div",V,[u("button",{onClick:s=>i.sortBy(l.name,!1),class:"btn btn-secundary btn-sm"},q,8,z),u("button",{onClick:s=>i.sortBy(l.name,!0),class:"btn btn-secundary btn-sm"},J,8,A)]),p(" "+b(l.placeholder),1)]))),128))])]),u("tbody",null,[e.hasPermission(e.moduleName,"create")&&e.moduleName!="logs"?(a(),n("tr",K,[u("td",null,[u("div",Q,[e.hasPermission(e.moduleName,"create")?(a(),n("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:r.Lenguages[r.Lenguages.selected].general.save,class:"btn btn-success",onClick:o[0]||(o[0]=l=>t.$emit("createOne",r.model))},W,8,R)):g("",!0),u("button",{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:r.Lenguages[r.Lenguages.selected].general.clear,class:"btn btn-warning",onClick:o[1]||(o[1]=l=>r.model=new e.Model({}))},Z,8,X)])]),(a(!0),n(h,null,y(e.fields,(l,c)=>(a(),n("td",{key:c,scope:"row"},[l.type=="status"?(a(),n(h,{key:0},[],64)):l.type=="combobox"||l.type=="multiple"?(a(),n("select",{key:1,name:l.name,index:-1,multiple:l.type=="multiple",id:l.type+"-1",onFocusout:s=>i.updateSelect(-1,l.name,s.target.value,l.type=="multiple"),class:"rounded border border-dark"},[(a(!0),n(h,null,y(e.auxiliar[l.target],s=>(a(),n("option",{value:s._id},b(s.name),9,ee))),256))],40,$)):l.type!="view"?(a(),C(m,{key:2,moduleName:e.moduleName,name:l.name,index:-1,type:l.type,placeholder:l.placeholder,value:r.model[l.name],validation:l.validation,message:l.message,onCellChange:i.onChange,onShowMessage:i.showMessage},null,8,["moduleName","name","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):g("",!0)]))),128))])):g("",!0),(a(!0),n(h,null,y(i.display,(l,c)=>(a(),n("tr",{key:c},[e.moduleName!="logs"?(a(),n("td",te,[u("div",se,[e.hasPermission(e.moduleName,"update")?(a(),n("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:r.Lenguages[r.Lenguages.selected].general.save,class:"btn btn-success",onClick:s=>t.$emit("updateOne",t.$refs.PageGenerator.getIndex(c))},ne,8,oe)):g("",!0),e.hasPermission(e.moduleName,"delete")?(a(),n("button",{key:1,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:r.Lenguages[r.Lenguages.selected].general.delete,class:"btn btn-danger",onClick:s=>t.$emit("deleteOne",t.$refs.PageGenerator.getIndex(c))},ie,8,le)):g("",!0)])])):g("",!0),(a(!0),n(h,null,y(e.fields,(s,w)=>(a(),n("td",{key:w,scope:"row"},[e.hasPermission(e.moduleName,"modify.status")&&s.type=="status"?(a(),n("button",ue,[p(b(this.format(l[s.name],s.format,s.target))+" ",1),u("ul",de,[u("li",null,[(a(!0),n(h,null,y(e.auxiliar[s.target],_=>(a(),n("a",{onClick:be=>t.$emit("changeStatus",c,_._id),class:"dropdown-item"},b(_.name),9,ce))),256))])])])):e.hasPermission(e.moduleName,"modify."+s.name)&&(s.type=="combobox"||s.type=="multiple")?(a(),n("select",{key:1,name:s.name,id:s.type+c,multiple:s.type=="multiple",onFocusout:_=>i.updateSelect(c,s.name,_.target.value,s.type=="multiple"),class:"rounded border border-dark"},[(a(!0),n(h,null,y(e.auxiliar[s.target],_=>(a(),n("option",{value:_._id,selected:i.checkSelected(_._id,l[s.name],s.type)},b(_.name),9,he))),256))],40,me)):e.hasPermission(e.moduleName,"modify."+s.name)&&s.type!="view"?(a(),C(m,{key:2,moduleName:e.moduleName,name:s.name,index:c,type:s.type,placeholder:s.placeholder,value:l[s.name],validation:s.validation,message:s.message,onCellChange:i.onChange,onShowMessage:i.showMessage},null,8,["moduleName","name","index","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):(a(),n("p",ge,b(this.format(l[s.name],s.format,s.target)),1))]))),128))]))),128))])])]),L(f,{ref:"PageGenerator"},null,512)],64)}const pe=v(O,[["render",_e]]);export{pe as E};
