import{F as k}from"./BackendConnection.98f6e596.js";import{_ as f,L as w,o as r,c as i,b as a,t as m,F as g,n as N,a as p,r as C,e as b,h as v,g as L,d as F}from"./index.e5ddf9d4.js";import{P}from"./PageGenerator.92949076.js";const S={emits:["exportData"],data(){return{Lenguages:w}},methods:{exportFile(s,t){const e=[],u=[];k[t].fields.forEach(c=>u.push(c.placeholder)),e.push(u.join(",")+`
`),s.forEach(c=>{const y=[];k[t].fields.forEach(d=>{c[d.name]?y.push(c[d.name]):y.push("")}),e.push(y.join(",")+`
`)});const o=new Blob(e,{type:"application/text"}),l=document.createElement("a");l.href=URL.createObjectURL(o),l.download=t+"_export.csv",l.click(),URL.revokeObjectURL(l.href)}}},E=["title"],M=a("i",{class:"fa fa-file-export"},null,-1),B=[M],O={class:"dropdown-menu"};function U(s,t,e,u,o,l){return r(),i(g,null,[a("button",{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.export,class:"btn text-light dropdown-toggle",style:{background:"#002133"}},B,8,E),a("ul",O,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:t[0]||(t[0]=c=>s.$emit("exportData",0))},m(this.Lenguages[this.Lenguages.selected].general.export_view),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:t[1]||(t[1]=c=>s.$emit("exportData",1))},m(this.Lenguages[this.Lenguages.selected].general.export_all),1)])])],64)}const Oe=f(S,[["render",U]]),D={props:["moduleName"],emits:["importData"],data(){return{Lenguages:w}},methods:{importFile(s){const t=s.target.files,e=new FileReader;e.onload=u=>{const o=u.target.result;console.log(o)},e.readAsText(t[0])},downloadFile(){const s=[],t=[];k[this.moduleName].fields.forEach(o=>t.push(o.placeholder)),s.push(t.join(",")+`
`);const e=new Blob(s,{type:"application/text"}),u=document.createElement("a");u.href=URL.createObjectURL(e),u.download=this.moduleName+"_template.csv",u.click(),URL.revokeObjectURL(u.href)}}},G=["title"],R=a("i",{class:"fa fa-file-import"},null,-1),j=[R],I={class:"dropdown-menu"};function T(s,t,e,u,o,l){return r(),i(g,null,[a("input",{ref:"FileUpload",type:"file",accept:".csv",onChange:t[0]||(t[0]=(...c)=>l.importFile&&l.importFile(...c)),hidden:""},null,544),a("button",{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.import,class:"btn text-light dropdown-toggle",style:{background:"#002133"}},j,8,G),a("ul",I,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:t[1]||(t[1]=(...c)=>l.downloadFile&&l.downloadFile(...c))},m(this.Lenguages[this.Lenguages.selected].general.import_template),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:t[2]||(t[2]=c=>s.$refs.FileUpload.click())},m(this.Lenguages[this.Lenguages.selected].general.import_file),1)])])],64)}const Ue=f(D,[["render",T]]),V={props:["moduleName","name","index","type","placeholder","value","target","validation","message"],emits:["cellChange","showMessage"],data(){return{error:!1,color:"rounded border border-success p-1"}},methods:{update(s){if(this.type=="checkbox")return this.$emit("cellChange",this.index,this.name,s.target.checked);if(this.type=="combobox")return this.$emit("cellChange",this.index,this.name,s.target.value);this.validation&&(this.error=!String(s.target.value).toLowerCase().match(this.validation)),this.error?this.color="rounded border border-danger p-1":this.color="rounded border border-warning p-1",this.error&&this.$emit("showMessage",this.message,"error"),this.$emit("cellChange",this.index,this.name,s.target.value)}}},z=["type","placeholder","value","id","checked"],A={key:0,class:"px-1"},q=["name","id"];function H(s,t,e,u,o,l){return r(),i("div",null,[a("input",{type:e.type,placeholder:e.placeholder,value:e.value,onChange:t[0]||(t[0]=(...c)=>l.update&&l.update(...c)),class:N(o.color),id:e.name,checked:e.value},null,42,z),e.type=="checkbox"?(r(),i("label",A,m(e.placeholder),1)):p("",!0),e.type=="button"?(r(),i("button",{key:1,name:e.name,id:e.index,onClick:t[1]||(t[1]=c=>s.$router.push("/"+s.ref)),class:"btn btn-secondary"},m(e.placeholder),9,q)):p("",!0)])}const J=f(V,[["render",H]]);const K={props:["token","user","moduleName","Model","models","fields","auxiliar","hasPermission"],emits:["showMessage","createOne","updateOne","deleteOne","changeStatus"],data(){return{model:{},Lenguages:w}},created(){this.clear()},computed:{display(){return this.models.length?this.$refs.PageGenerator.paginate(this.models):[]}},methods:{clear(){this.model=new this.Model({})},showMessage(s,t){this.$emit("showMessage",s,t)},onChange(s,t,e){if(s==-1)this.model[t]=e;else{const u=this.$refs.PageGenerator.getIndex(s);this.models[u][t]=e}},format(s,t,e){if(t){if(t=="datetime")return new Date(s).toLocaleString();if(t=="date")return new Date(s).toLocaleDateString();if(t=="time")return new Date(s).toLocaleTimeString();if(t=="checkbox")return s?"S\xED":"No";if(t=="combobox"||t=="status"){const u=this.auxiliar[e].find(o=>o._id===s);return u?u.name:s}else if(t=="multiple"){let u="";return s.forEach(o=>{const l=this.auxiliar[e].find(c=>c._id===o);l&&(u+=l.name+`
`)}),u}}else return s},sortBy(s,t=!1){this.models.sort((e,u)=>{let o=e[s].toLowerCase(),l=u[s].toLowerCase();return t?o<l?1:o>l?-1:0:o<l?-1:o>l?1:0})},updateSelect(s,t,e,u=!1){if(u){const o=[],l=document.getElementById("multiple"+s).options;for(const c of l)c.selected&&o.push(c.value);s!=-1?this.models[s][t]=o:this.model[t]=o}else s!=-1?this.models[this.$refs.PageGenerator.getIndex(s)][t]=e:this.model[t]=e},checkSelected(s,t,e){return e=="multiple"?t.find(u=>u==s):s==t}},components:{EditableCell:J,PageGenerator:P}},Q={class:"row mt-1"},W={class:"table table-striped mt-3"},X={key:0},Y={class:"btn-group-vertical"},Z=["onClick"],$=a("i",{class:"fa-solid fa-arrow-up-a-z"},null,-1),ee=[$],te=["onClick"],se=a("i",{class:"fa-solid fa-arrow-down-z-a"},null,-1),oe=[se],ne={key:0},ae={class:"btn-group"},le=["title"],re=a("i",{class:"fa-solid fa-floppy-disk"},null,-1),ie=[re],de=["title"],ue=a("i",{class:"fa-solid fa-delete-left"},null,-1),ce=[ue],me=["name","multiple","id","onFocusout"],he=["value"],ge={key:0},pe={class:"btn-group"},_e=["title","onClick"],be=a("i",{class:"fa-solid fa-floppy-disk"},null,-1),ye=[be],fe=["title","onClick"],ke=a("i",{class:"fa-solid fa-trash"},null,-1),we=[ke],Ce={key:0,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:"Cambiar estado",class:"btn text-light",style:{background:"#002133"}},ve={class:"dropdown-menu"},Le=["onClick"],xe=["name","id","multiple","onFocusout"],Ne=["value","selected"],Fe={key:3};function Pe(s,t,e,u,o,l){const c=C("EditableCell"),y=C("PageGenerator");return r(),i(g,null,[a("div",Q,[a("table",W,[a("thead",null,[a("tr",null,[e.moduleName!="logs"?(r(),i("th",X)):p("",!0),(r(!0),i(g,null,b(e.fields,(d,h)=>(r(),i("th",{key:h,scope:"col"},[a("div",Y,[a("button",{onClick:n=>l.sortBy(d.name,!1),class:"btn btn-secundary btn-sm"},ee,8,Z),a("button",{onClick:n=>l.sortBy(d.name,!0),class:"btn btn-secundary btn-sm"},oe,8,te)]),v(" "+m(d.placeholder),1)]))),128))])]),a("tbody",null,[e.hasPermission(e.moduleName,"create")&&e.moduleName!="logs"?(r(),i("tr",ne,[a("td",null,[a("div",ae,[e.hasPermission(e.moduleName,"create")?(r(),i("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.save,class:"btn btn-success",onClick:t[0]||(t[0]=d=>s.$emit("createOne",o.model))},ie,8,le)):p("",!0),a("button",{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.clear,class:"btn btn-warning",onClick:t[1]||(t[1]=d=>o.model=new e.Model({}))},ce,8,de)])]),(r(!0),i(g,null,b(e.fields,(d,h)=>(r(),i("td",{key:h,scope:"row"},[d.type=="status"?(r(),i(g,{key:0},[],64)):d.type=="combobox"||d.type=="multiple"?(r(),i("select",{key:1,name:d.name,index:-1,multiple:d.type=="multiple",id:d.type+"-1",onFocusout:n=>l.updateSelect(-1,d.name,n.target.value,d.type=="multiple"),class:"rounded border border-dark"},[(r(!0),i(g,null,b(e.auxiliar[d.target],n=>(r(),i("option",{value:n._id},m(n.name),9,he))),256))],40,me)):d.type!="view"?(r(),L(c,{key:2,moduleName:e.moduleName,name:d.name,index:-1,type:d.type,placeholder:d.placeholder,value:o.model[d.name],validation:d.validation,message:d.message,onCellChange:l.onChange,onShowMessage:l.showMessage},null,8,["moduleName","name","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):p("",!0)]))),128))])):p("",!0),(r(!0),i(g,null,b(l.display,(d,h)=>(r(),i("tr",{key:h},[e.moduleName!="logs"?(r(),i("td",ge,[a("div",pe,[e.hasPermission(e.moduleName,"update")?(r(),i("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.save,class:"btn btn-success",onClick:n=>s.$emit("updateOne",s.$refs.PageGenerator.getIndex(h))},ye,8,_e)):p("",!0),e.hasPermission(e.moduleName,"delete")?(r(),i("button",{key:1,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.delete,class:"btn btn-danger",onClick:n=>s.$emit("deleteOne",s.$refs.PageGenerator.getIndex(h))},we,8,fe)):p("",!0)])])):p("",!0),(r(!0),i(g,null,b(e.fields,(n,x)=>(r(),i("td",{key:x,scope:"row"},[e.hasPermission(e.moduleName,"modify.status")&&n.type=="status"?(r(),i("button",Ce,[v(m(this.format(d[n.name],n.format,n.target))+" ",1),a("ul",ve,[a("li",null,[(r(!0),i(g,null,b(e.auxiliar[n.target],_=>(r(),i("a",{onClick:Se=>s.$emit("changeStatus",h,_._id),class:"dropdown-item"},m(_.name),9,Le))),256))])])])):e.hasPermission(e.moduleName,"modify."+n.name)&&(n.type=="combobox"||n.type=="multiple")?(r(),i("select",{key:1,name:n.name,id:n.type+h,multiple:n.type=="multiple",onFocusout:_=>l.updateSelect(h,n.name,_.target.value,n.type=="multiple"),class:"rounded border border-dark"},[(r(!0),i(g,null,b(e.auxiliar[n.target],_=>(r(),i("option",{value:_._id,selected:l.checkSelected(_._id,d[n.name],n.type)},m(_.name),9,Ne))),256))],40,xe)):e.hasPermission(e.moduleName,"modify."+n.name)&&n.type!="view"?(r(),L(c,{key:2,moduleName:e.moduleName,name:n.name,index:h,type:n.type,placeholder:n.placeholder,value:d[n.name],validation:n.validation,message:n.message,onCellChange:l.onChange,onShowMessage:l.showMessage},null,8,["moduleName","name","index","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):(r(),i("p",Fe,m(this.format(d[n.name],n.format,n.target)),1))]))),128))]))),128))])])]),F(y,{ref:"PageGenerator"},null,512)],64)}const De=f(K,[["render",Pe]]);export{Oe as E,Ue as I,De as a};
