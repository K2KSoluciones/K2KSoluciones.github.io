import{_ as f,o as n,c as a,d,n as N,t as b,a as _,L as x,r as k,F as g,f as y,i as p,h as C,e as L}from"./index.99972e7e.js";import{P}from"./PageGenerator.0dd20328.js";const S={props:["moduleName","name","index","type","placeholder","value","target","validation","message"],emits:["cellChange","showMessage"],data(){return{error:!1,color:"rounded border border-success p-1"}},methods:{update(t){if(this.type=="checkbox")return this.$emit("cellChange",this.index,this.name,t.target.checked);if(this.type=="combobox")return this.$emit("cellChange",this.index,this.name,t.target.value);this.validation&&(this.error=!String(t.target.value).toLowerCase().match(this.validation)),this.error?this.color="rounded border border-danger p-1":this.color="rounded border border-warning p-1",this.error&&this.$emit("showMessage",this.message,"error"),this.$emit("cellChange",this.index,this.name,t.target.value)}}},M=["type","placeholder","value","id","checked"],E={key:0,class:"px-1"},G=["name","id"];function B(t,o,e,u,i,r){return n(),a("div",null,[d("input",{type:e.type,placeholder:e.placeholder,value:e.value,onChange:o[0]||(o[0]=(...m)=>r.update&&r.update(...m)),class:N(i.color),id:e.name,checked:e.value},null,42,M),e.type=="checkbox"?(n(),a("label",E,b(e.placeholder),1)):_("",!0),e.type=="button"?(n(),a("button",{key:1,name:e.name,id:e.index,onClick:o[1]||(o[1]=m=>t.$router.push("/"+t.ref)),class:"btn btn-secondary"},b(e.placeholder),9,G)):_("",!0)])}const F=f(S,[["render",B]]);const O={props:["token","user","moduleName","Model","models","fields","auxiliar","hasPermission"],emits:["showMessage","createOne","updateOne","deleteOne","changeStatus"],data(){return{model:{},Lenguages:x}},created(){this.clear()},computed:{display(){return this.models.length?this.$refs.PageGenerator.paginate(this.models):[]}},methods:{clear(){this.model=new this.Model({})},showMessage(t,o){this.$emit("showMessage",t,o)},onChange(t,o,e){if(t==-1)this.model[o]=e;else{const u=this.$refs.PageGenerator.getIndex(t);this.models[u][o]=e}},format(t,o,e){if(o){if(o=="datetime")return new Date(t).toLocaleString();if(o=="date")return new Date(t).toLocaleDateString();if(o=="time")return new Date(t).toLocaleTimeString();if(o=="checkbox")return t?"S\xED":"No";if(o=="combobox"||o=="status"){const u=this.auxiliar[e].find(i=>i._id===t);return u?u.name:t}else if(o=="multiple"){let u="";return t.forEach(i=>{const r=this.auxiliar[e].find(m=>m._id===i);r&&(u+=r.name+`
`)}),u}}else return t},sortBy(t,o=!1){this.models.sort((e,u)=>{let i=e[t].toLowerCase(),r=u[t].toLowerCase();return o?i<r?1:i>r?-1:0:i<r?-1:i>r?1:0})},updateSelect(t,o,e,u=!1){if(u){const i=[],r=document.getElementById("multiple"+t).options;for(const m of r)m.selected&&i.push(m.value);t!=-1?this.models[t][o]=i:this.model[o]=i}else t!=-1?this.models[this.$refs.PageGenerator.getIndex(t)][o]=e:this.model[o]=e},checkSelected(t,o,e){return!1}},components:{EditableCell:F,PageGenerator:P}},D={class:"row mt-1"},I={class:"table table-striped mt-3"},T={key:0},V={class:"btn-group-vertical"},z=["onClick"],j=d("i",{class:"fa-solid fa-arrow-up-a-z"},null,-1),q=[j],A=["onClick"],H=d("i",{class:"fa-solid fa-arrow-down-z-a"},null,-1),J=[H],K={key:0},Q={class:"btn-group"},R=["title"],U=d("i",{class:"fa-solid fa-floppy-disk"},null,-1),W=[U],X=["title"],Y=d("i",{class:"fa-solid fa-delete-left"},null,-1),Z=[Y],$=["name","multiple","id","onFocusout"],ee=["value"],te={key:0},se={class:"btn-group"},oe=["title","onClick"],ne=d("i",{class:"fa-solid fa-floppy-disk"},null,-1),ae=[ne],le=["title","onClick"],ie=d("i",{class:"fa-solid fa-trash"},null,-1),re=[ie],de={key:0,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:"Cambiar estado",class:"btn text-light",style:{background:"#002133"}},ue={class:"dropdown-menu"},ce=["onClick"],me=["name","id","multiple","onFocusout"],he=["value","selected"],ge={key:3};function _e(t,o,e,u,i,r){const m=k("EditableCell"),v=k("PageGenerator");return n(),a(g,null,[d("div",D,[d("table",I,[d("thead",null,[d("tr",null,[e.moduleName!="logs"?(n(),a("th",T)):_("",!0),(n(!0),a(g,null,y(e.fields,(l,c)=>(n(),a("th",{key:c,scope:"col"},[d("div",V,[d("button",{onClick:s=>r.sortBy(l.name,!1),class:"btn btn-secundary btn-sm"},q,8,z),d("button",{onClick:s=>r.sortBy(l.name,!0),class:"btn btn-secundary btn-sm"},J,8,A)]),p(" "+b(l.placeholder),1)]))),128))])]),d("tbody",null,[e.hasPermission(e.moduleName,"create")&&e.moduleName!="logs"?(n(),a("tr",K,[d("td",null,[d("div",Q,[e.hasPermission(e.moduleName,"create")?(n(),a("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:i.Lenguages[i.Lenguages.selected].general.save,class:"btn btn-success",onClick:o[0]||(o[0]=l=>t.$emit("createOne",i.model))},W,8,R)):_("",!0),d("button",{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:i.Lenguages[i.Lenguages.selected].general.clear,class:"btn btn-warning",onClick:o[1]||(o[1]=l=>i.model=new e.Model({}))},Z,8,X)])]),(n(!0),a(g,null,y(e.fields,(l,c)=>(n(),a("td",{key:c,scope:"row"},[l.type=="status"?(n(),a(g,{key:0},[],64)):l.type=="combobox"||l.type=="multiple"?(n(),a("select",{key:1,name:l.name,index:-1,multiple:l.type=="multiple",id:l.type+"-1",onFocusout:s=>r.updateSelect(-1,l.name,s.target.value,l.type=="multiple"),class:"rounded border border-dark"},[(n(!0),a(g,null,y(e.auxiliar[l.target],s=>(n(),a("option",{value:s.id},b("("+s.identification+") "+s.nombre),9,ee))),256))],40,$)):l.type!="view"?(n(),C(m,{key:2,moduleName:e.moduleName,name:l.name,index:-1,type:l.type,placeholder:l.placeholder,value:i.model[l.name],validation:l.validation,message:l.message,onCellChange:r.onChange,onShowMessage:r.showMessage},null,8,["moduleName","name","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):_("",!0)]))),128))])):_("",!0),(n(!0),a(g,null,y(r.display,(l,c)=>(n(),a("tr",{key:c},[e.moduleName!="logs"?(n(),a("td",te,[d("div",se,[e.hasPermission(e.moduleName,"update")?(n(),a("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:i.Lenguages[i.Lenguages.selected].general.save,class:"btn btn-success",onClick:s=>t.$emit("updateOne",t.$refs.PageGenerator.getIndex(c))},ae,8,oe)):_("",!0),e.hasPermission(e.moduleName,"delete")?(n(),a("button",{key:1,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:i.Lenguages[i.Lenguages.selected].general.delete,class:"btn btn-danger",onClick:s=>t.$emit("deleteOne",t.$refs.PageGenerator.getIndex(c))},re,8,le)):_("",!0)])])):_("",!0),(n(!0),a(g,null,y(e.fields,(s,w)=>(n(),a("td",{key:w,scope:"row"},[e.hasPermission(e.moduleName,"modify.status")&&s.type=="status"?(n(),a("button",de,[p(b(this.format(l[s.name],s.format,s.target))+" ",1),d("ul",ue,[d("li",null,[(n(!0),a(g,null,y(e.auxiliar[s.target],h=>(n(),a("a",{onClick:be=>t.$emit("changeStatus",c,h._id),class:"dropdown-item"},b(h.name),9,ce))),256))])])])):e.hasPermission(e.moduleName,"modify."+s.name)&&(s.type=="combobox"||s.type=="multiple")?(n(),a("select",{key:1,name:s.name,id:s.type+c,multiple:s.type=="multiple",onFocusout:h=>r.updateSelect(c,s.name,h.target.value,s.type=="multiple"),class:"rounded border border-dark"},[(n(!0),a(g,null,y(e.auxiliar[s.target],h=>(n(),a("option",{value:h.id,selected:r.checkSelected(h.id,l[s.name],s.type)},b("("+h.identification+") "+h.nombre),9,he))),256))],40,me)):e.hasPermission(e.moduleName,"modify."+s.name)&&s.type!="view"?(n(),C(m,{key:2,moduleName:e.moduleName,name:s.name,index:c,type:s.type,placeholder:s.placeholder,value:l[s.name],validation:s.validation,message:s.message,onCellChange:r.onChange,onShowMessage:r.showMessage},null,8,["moduleName","name","index","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):(n(),a("p",ge,b(this.format(l[s.name],s.format,s.target)),1))]))),128))]))),128))])])]),L(v,{ref:"PageGenerator"},null,512)],64)}const pe=f(O,[["render",_e]]);export{pe as E};
