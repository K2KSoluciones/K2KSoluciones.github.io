import{_ as w,o as l,c as i,d,n as N,t as b,a as _,L as P,r as k,F as g,f as y,i as f,h as C,e as S}from"./index.43b59b4f.js";import{P as x}from"./PageGenerator.579fd638.js";const L={props:["moduleName","name","index","type","placeholder","value","target","validation","message"],emits:["cellChange","showMessage"],data(){return{error:!1,color:"rounded border border-success p-1"}},methods:{update(t){if(this.type=="checkbox")return this.$emit("cellChange",this.index,this.name,t.target.checked);if(this.type=="combobox")return this.$emit("cellChange",this.index,this.name,t.target.value);this.validation&&(this.error=!String(t.target.value).toLowerCase().match(this.validation)),this.error?this.color="rounded border border-danger p-1":this.color="rounded border border-warning p-1",this.error&&this.$emit("showMessage",this.message,"error"),this.$emit("cellChange",this.index,this.name,t.target.value)}}},M=["type","placeholder","value","id","checked"],G={key:0,class:"px-1"},E=["name","id"];function O(t,n,e,c,o,r){return l(),i("div",null,[d("input",{type:e.type,placeholder:e.placeholder,value:e.value,onChange:n[0]||(n[0]=(...h)=>r.update&&r.update(...h)),class:N(o.color),id:e.name,checked:e.value},null,42,M),e.type=="checkbox"?(l(),i("label",G,b(e.placeholder),1)):_("",!0),e.type=="button"?(l(),i("button",{key:1,name:e.name,id:e.index,onClick:n[1]||(n[1]=h=>t.$router.push("/"+t.ref)),class:"btn btn-secondary"},b(e.placeholder),9,E)):_("",!0)])}const B=w(L,[["render",O]]);const I={props:["token","user","moduleName","Model","models","fields","auxiliar","hasPermission"],emits:["showMessage","createOne","updateOne","deleteOne","changeStatus"],data(){return{model:{},Lenguages:P}},created(){this.clear()},computed:{display(){return this.models.length?this.$refs.PageGenerator.paginate(this.models):[]}},methods:{clear(){this.model=new this.Model({})},showMessage(t,n){this.$emit("showMessage",t,n)},onChange(t,n,e){if(t==-1)this.model[n]=e;else{const c=this.$refs.PageGenerator.getIndex(t);this.models[c][n]=e}},format(t,n,e){if(n){if(n=="datetime")return t?new Date(t).toLocaleString():"";if(n=="date")return t?new Date(t).toLocaleDateString():"";if(n=="time")return t?new Date(t).toLocaleTimeString():"";if(n=="checkbox")return t?"S\xED":"No";if(n=="combobox"||n=="status"){const c=this.auxiliar[e].find(o=>o._id===t);return c?c.name:t}else if(n=="multiple"){let c="";return t.forEach(o=>{const r=this.auxiliar[e].find(h=>h._id===o);r&&(c+=r.name+`
`)}),c}}else return t},sortBy(t,n=!1){this.models.sort((e,c)=>{let o=e[t],r=c[t];return typeof o=="string"&&(o=o.toLowerCase()),typeof r=="string"&&(r=r.toLowerCase()),n?o<r?1:o>r?-1:0:o<r?-1:o>r?1:0})},updateSelect(t,n,e,c=!1){if(c){n=="integrantes"&&(t==-1&&this.model[n]==null&&(this.model[n]={integrantes:[]}),t!=-1&&this.models[this.$refs.PageGenerator.getIndex(t)][n]==null&&(this.models[this.$refs.PageGenerator.getIndex(t)][n]={integrantes:[]}));let o="";const r=document.getElementById("multiple"+t).options;for(const a of r)a.selected&&(o=a.value);const h=o.split(") ")[0].replaceAll("(",""),p={};p[h]=o.split(") ")[1],t!=-1?this.models[this.$refs.PageGenerator.getIndex(t)][n].integrantes.push(p):this.model[n].integrantes.push(p)}else{const o=e.split(") ")[0].replaceAll("(",""),r={};r[o]=e.split(") ")[1],t!=-1?this.models[this.$refs.PageGenerator.getIndex(t)][n]=JSON.stringify(r):this.model[n]=JSON.stringify(r)}},checkSelected(t,n,e){try{return!n||(n=JSON.parse(n),e=="multiple")?!1:n[t]!=null}catch{return!1}}},components:{EditableCell:B,PageGenerator:x}},D={class:"row mt-1"},T={class:"table table-striped mt-3"},V={key:0},z={class:"btn-group-vertical"},J=["onClick"],A=d("i",{class:"fa-solid fa-arrow-up-a-z"},null,-1),F=[A],j=["onClick"],q=d("i",{class:"fa-solid fa-arrow-down-z-a"},null,-1),H=[q],K={key:0},Q={class:"btn-group"},R=["title"],U=d("i",{class:"fa-solid fa-floppy-disk"},null,-1),W=[U],X=["title"],Y=d("i",{class:"fa-solid fa-delete-left"},null,-1),Z=[Y],$=["name","multiple","id","onChange"],ee=["value"],te={key:0},se={class:"btn-group"},ne=["title","onClick"],oe=d("i",{class:"fa-solid fa-floppy-disk"},null,-1),ae=[oe],le=["title","onClick"],re=d("i",{class:"fa-solid fa-trash"},null,-1),ie=[re],de={key:0,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-toggle":"tooltip","data-placement":"bottom",title:"Cambiar estado",class:"btn text-light",style:{background:"#002133"}},ce={class:"dropdown-menu"},ue=["onClick"],me=["name","id","multiple","onChange"],he=["value","selected"],ge={key:3};function _e(t,n,e,c,o,r){const h=k("EditableCell"),p=k("PageGenerator");return l(),i(g,null,[d("div",D,[d("table",T,[d("thead",null,[d("tr",null,[e.moduleName!="logs"?(l(),i("th",V)):_("",!0),(l(!0),i(g,null,y(e.fields,(a,u)=>(l(),i("th",{key:u,scope:"col"},[d("div",z,[d("button",{onClick:s=>r.sortBy(a.name,!1),class:"btn btn-secundary btn-sm"},F,8,J),d("button",{onClick:s=>r.sortBy(a.name,!0),class:"btn btn-secundary btn-sm"},H,8,j)]),f(" "+b(a.placeholder),1)]))),128))])]),d("tbody",null,[e.hasPermission(e.moduleName,"create")&&e.moduleName!="logs"?(l(),i("tr",K,[d("td",null,[d("div",Q,[e.hasPermission(e.moduleName,"create")?(l(),i("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.save,class:"btn btn-success",onClick:n[0]||(n[0]=a=>t.$emit("createOne",o.model))},W,8,R)):_("",!0),d("button",{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.clear,class:"btn btn-warning",onClick:n[1]||(n[1]=a=>o.model=new e.Model({}))},Z,8,X)])]),(l(!0),i(g,null,y(e.fields,(a,u)=>(l(),i("td",{key:u,scope:"row"},[a.type=="status"?(l(),i(g,{key:0},[],64)):a.type=="combobox"||a.type=="multiple"?(l(),i("select",{key:1,name:a.name,index:-1,multiple:a.type=="multiple",id:a.type+"-1",onChange:s=>r.updateSelect(-1,a.name,s.target.value,a.type=="multiple"),class:"rounded border border-dark"},[(l(!0),i(g,null,y(e.auxiliar[a.target],s=>(l(),i("option",{value:"("+s.identification+") "+s.nombre},b("("+s.identification+") "+s.nombre),9,ee))),256))],40,$)):a.type!="view"?(l(),C(h,{key:2,moduleName:e.moduleName,name:a.name,index:-1,type:a.type,placeholder:a.placeholder,value:o.model[a.name],validation:a.validation,message:a.message,onCellChange:r.onChange,onShowMessage:r.showMessage},null,8,["moduleName","name","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):_("",!0)]))),128))])):_("",!0),(l(!0),i(g,null,y(r.display,(a,u)=>(l(),i("tr",{key:u},[e.moduleName!="logs"?(l(),i("td",te,[d("div",se,[e.hasPermission(e.moduleName,"update")?(l(),i("button",{key:0,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.save,class:"btn btn-success",onClick:s=>t.$emit("updateOne",t.$refs.PageGenerator.getIndex(u))},ae,8,ne)):_("",!0),e.hasPermission(e.moduleName,"delete")?(l(),i("button",{key:1,type:"button","data-toggle":"tooltip","data-placement":"bottom",title:o.Lenguages[o.Lenguages.selected].general.delete,class:"btn btn-danger",onClick:s=>t.$emit("deleteOne",t.$refs.PageGenerator.getIndex(u))},ie,8,le)):_("",!0)])])):_("",!0),(l(!0),i(g,null,y(e.fields,(s,v)=>(l(),i("td",{key:v,scope:"row"},[e.hasPermission(e.moduleName,"modify.status")&&s.type=="status"?(l(),i("button",de,[f(b(this.format(a[s.name],s.format,s.target))+" ",1),d("ul",ce,[d("li",null,[(l(!0),i(g,null,y(e.auxiliar[s.target],m=>(l(),i("a",{onClick:be=>t.$emit("changeStatus",u,m._id),class:"dropdown-item"},b(m.name),9,ue))),256))])])])):e.hasPermission(e.moduleName,"modify."+s.name)&&(s.type=="combobox"||s.type=="multiple")&&!a[s.name]?(l(),i("select",{key:1,name:s.name,id:s.type+u,multiple:s.type=="multiple",onChange:m=>r.updateSelect(u,s.name,m.target.value,s.type=="multiple"),class:"rounded border border-dark"},[(l(!0),i(g,null,y(e.auxiliar[s.target],m=>(l(),i("option",{value:"("+m.identification+") "+m.nombre,selected:r.checkSelected(m.nombre,a[s.name],s.type)},b("("+m.identification+") "+m.nombre),9,he))),256))],40,me)):e.hasPermission(e.moduleName,"modify."+s.name)&&s.type!="view"&&s.type!="combobox"&&s.type!="multiple"?(l(),C(h,{key:2,moduleName:e.moduleName,name:s.name,index:u,type:s.type,placeholder:s.placeholder,value:a[s.name],validation:s.validation,message:s.message,onCellChange:r.onChange,onShowMessage:r.showMessage},null,8,["moduleName","name","index","type","placeholder","value","validation","message","onCellChange","onShowMessage"])):(l(),i("p",ge,b(this.format(a[s.name],s.format,s.target)),1))]))),128))]))),128))])])]),S(p,{ref:"PageGenerator"},null,512)],64)}const ke=w(I,[["render",_e]]);export{ke as E};
